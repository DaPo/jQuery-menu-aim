(function(e){e.fn.menuAim=function(e){this.each(function(){t.call(this,e)});return this};function t(t){var n=e(this),i=null,o=[],r=null,u=null,l=e.extend({rowSelector:"> li",submenuSelector:"*",submenuDirection:"right",tolerance:75,enter:e.noop,exit:e.noop,activate:e.noop,deactivate:e.noop,exitMenu:e.noop},t);var c=3,f=300;var a=function(e){o.push({x:e.pageX,y:e.pageY});if(o.length>c){o.shift()}};var s=function(){if(u){clearTimeout(u)}if(l.exitMenu(this)){if(i){l.deactivate(i)}i=null}};var v=function(){if(u){clearTimeout(u)}l.enter(this);y(this)},m=function(){l.exit(this)};var x=function(){h(this)};var h=function(e){if(e==i){return}if(i){l.deactivate(i)}l.activate(e);i=e};var y=function(e){var t=b();if(t){u=setTimeout(function(){y(e)},t)}else{h(e)}};var b=function(){if(!i||!e(i).is(l.submenuSelector)){return 0}var t=n.offset(),u={x:t.left,y:t.top},c={x:t.left+n.outerWidth(),y:u.y},a={x:t.left,y:t.top+n.outerHeight()},s={x:t.left+n.outerWidth(),y:a.y},v=o[o.length-1],m=o[0];if(!v){return 0}if(!m){m=v}if(l.submenuDirection=="right"){c.y-=l.tolerance;s.y+=l.tolerance}else if(l.submenuDirection=="left"){u.y-=l.tolerance;a.y+=l.tolerance}else if(l.submenuDirection=="above"){u.x-=l.tolerance;c.x+=l.tolerance}else if(l.submenuDirection=="below"){a.x-=l.tolerance;s.x+=l.tolerance}if(m.x<t.left||m.x>s.x||m.y<t.top||m.y>s.y){return 0}if(r&&v.x==r.x&&v.y==r.y){return 0}function x(e,t){return(t.y-e.y)/(t.x-e.x)}var h=c,y=s;if(l.submenuDirection=="left"){h=a;y=u}else if(l.submenuDirection=="below"){h=s;y=a}else if(l.submenuDirection=="above"){h=u;y=c}var b=x(v,h),p=x(v,y),d=x(m,h),D=x(m,y);if(b<d&&p>D){r=v;return f}r=null;return 0};n.mouseleave(s).find(l.rowSelector).mouseenter(v).mouseleave(m).click(x);e(document).mousemove(a)}})(jQuery);